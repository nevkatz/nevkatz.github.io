<!DOCTYPE html>
<html lang="en"><!-- http://jovandeginste.github.io/2016/05/18/add-metadata-tags-to-jekyll-blog-posts.html   -->
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146443473-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-146443473-1');
</script>
<script data-ad-client="ca-pub-9580495616409314" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:url" content="/2021/03/13/drupal-migration-takeaways.html" />
  
  <meta itemprop="keywords" content="web,database">
  

  
  <meta itemprop="tags" content="web,database">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>21 Tips for Drupal Database Migrations | Nevin Katz</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="21 Tips for Drupal Database Migrations" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Migrating from Drupal 7 to Drupal 8 or 9" />
<meta property="og:description" content="Migrating from Drupal 7 to Drupal 8 or 9" />
<link rel="canonical" href="/2021/03/13/drupal-migration-takeaways.html" />
<meta property="og:url" content="/2021/03/13/drupal-migration-takeaways.html" />
<meta property="og:site_name" content="Nevin Katz" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-03-13T00:00:00-05:00" />
<script type="application/ld+json">
{"headline":"21 Tips for Drupal Database Migrations","dateModified":"2021-03-13T00:00:00-05:00","datePublished":"2021-03-13T00:00:00-05:00","url":"/2021/03/13/drupal-migration-takeaways.html","mainEntityOfPage":{"@type":"WebPage","@id":"/2021/03/13/drupal-migration-takeaways.html"},"description":"Migrating from Drupal 7 to Drupal 8 or 9","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<!-- this is where the CSS is. -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/prism.css">
  <link rel="stylesheet" href="/assets/css/styles.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Nevin Katz" /></head>
<body data-title="21 Tips for Drupal Database Migrations" ><header class="site-header" role="banner">

  <div class="wrapper"><div id="header-logo">
    <a class="site-title" rel="author" href="/">
      Nevin Katz
    </a>
    <a class="site-subtitle" rel="title" href="/">
      Web &amp; App Developer</a>
    </div><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <!--<a class="page-link" href="/404.html">Page Not Found</a><a class="page-link" href="/about/">About</a><a class="page-link" href="/tag/animation/">Animation</a><a class="page-link" href="/tag/arrays/">Arrays</a><a class="page-link" href="/tag/async/">Async Requests</a><a class="page-link" href="/tag/cli/">cli (Command Line Interface)</a><a class="page-link" href="/tag/cms/">CMS (Content Management System)</a><a class="page-link" href="/tag/comics/">Comics</a><a class="page-link" href="/tag/css-grid/">CSS Grid</a><a class="page-link" href="/tag/css-styles/">CSS</a><a class="page-link" href="/tag/database/">Database</a><a class="page-link" href="/tag/docs/">Documentation</a><a class="page-link" href="/tag/drupal-cms/">Drupal CMS</a><a class="page-link" href="/tag/edtech/">CSS Grid</a><a class="page-link" href="/tag/flexbox/">Flexbox</a><a class="page-link" href="/tag/html/">HTML</a><a class="page-link" href="/tag/images/">Images</a><a class="page-link" href="/tag/io/">I/O (Input / Output)</a><a class="page-link" href="/tag/mobile/">Mobile</a><a class="page-link" href="/project-management/">Project Management</a><a class="page-link" href="/tag/qa/">QA (Quality Assurance)</a><a class="page-link" href="/tag/static/">Static</a><a class="page-link" href="/tag/themes/">Themes</a><a class="page-link" href="/tag/web/">Web</a><a class="page-link" href="/index.html">Nevin Katz</a><a class="page-link" href="/index.html">Nevin Katz</a>-->
           <div id="top-nav"><a class="page-link" href="/about">About</a></div>
           <div id="search-container">
                 <input type="text" id="search-input" placeholder="Search">
                 <!-- search results container - maybe put elsewhere -->
           </div>
        </div>
      </nav></div>
  <div class="category-nav" id="top-category-nav">
        <ul>
          <li><a class="css" href="/category/css">CSS</a></li>
          <li><a class="css" href="/category/svg">SVG</a></li>
          <li><a class="javascript" href="/category/javascript">Javascript</a></li>
          <li><a class="vue" href="/category/vue">Vue</a></li>
          <li><a class="nodejs" href="/category/nodejs">Node JS</a></li>
          <li><a class="drupal" href="/category/drupal">Drupal</a></li>
        </ul>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <ul id="results-container"></ul>

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">21 Tips for Drupal Database Migrations</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-03-13T00:00:00-05:00" itemprop="datePublished">Mar 13, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h3 id="migrating-from-drupal-7-to-drupal-8-or-9">Migrating from Drupal 7 to Drupal 8 or 9</h3>

<p>With Drupal 7 losing support in November 2022, you may be looking to migrate a Drupal 7 site to Drupal 8 or 9 some time soon. If so, here are a few tips I gleaned from migrating my Drupal 7 site’s database to Drupal 9 through my web browser.</p>

<h3 id="general-tips">General Tips</h3>

<ol>
  <li>
    <p><strong>Study the documentation.</strong> To prepare, I studied Drupal’s <a href="https://www.drupal.org/docs/upgrading-drupal/upgrade-using-web-browser" target="_blank">Upgrade Using Web Browser</a> guide, and referred to this resource often during the migration. The guide provided a helpful walkthrough of the process with screenshots of the key stages. While there are other approaches that may be better suited to complex migrations, this approach covers the essentials and is often a fine one to try at the outset.</p>
  </li>
  <li>
    <p><strong>In most cases, migrate directly to Drupal 9.</strong> Because Drupal 8 <a href="https://www.drupal.org/about/core/policies/core-release-cycles/drupal-core-release-cycle-major-minor-and-patch-releases#drupal-8-eol" target="_blank">loses support</a> in November 2021, you would not be able to stay with it for long at this point. And Drupal 9 is very similar to Drupal 8 - just more streamlined without the deprecated modules and APIs that some Drupal 8 sites may allow. While migrating from D8 to D9 is <a href="https://www.drupal.org/node/2941566" target="_blank">less of a challenge</a> than migrating from D7 to D8, it can still be arduous if you end up migrating from D7 to D8 and are using some modules that D8 supports but D9 will not. So migrating directly to D9 can potentially save you time and cost.</p>
  </li>
  <li>
    <p><strong>Try migrating locally with Lando.</strong> <a href="https://lando.dev/" target="_blank">Lando</a> is a free open-source command-line tool for setting up a range of dev environments. It is built on top of <a href="https://www.docker.com/" target="_blank">Docker</a> tech, and if you download it, you will end up downloading Docker as well if you do not already have it. When used with Drupal, Lando spins off your database and sets up your <code>settings.php</code> file automatically with the initial username, password, and database name. These credentials are easy to find, using either <code>lando info</code> from the command line or Docker’s dashboard. I set up both my D7 and D9 sites with Lando, and once I used <code>lando info</code> to view my D7 site’s hostname and database credentials, connecting my D9 site to the D7 site’s database went off without a hitch.</p>
  </li>
  <li>
    <p><strong>Use Git to version-control your work.</strong> If you are <a href="https://www.freecodecamp.org/news/what-is-git-and-how-to-use-it-c341b049ae61/" target="_blank">new to Git</a>, this is a good time to start using it. I have both my old D7 and new D9 sites wired to separate Git repositories, which I use for file version-control. After initiating a git repository in your site directory, you can create a <code>.gitignore</code> file to ensure that Git will not track files that you do not want local and remote versions of your site to share. For me, these include <code>settings.php</code> and the <code>files</code> directory. You can deploy a Git-wired site by pushing it to a cloud service like Github, Acquia Cloud, Bitbucket, and then pulling it to your server, and then by pushing up your files using another method such as SFTP.</p>
  </li>
  <li>
    <p><strong>Plan to make database backups frequently.</strong> As you prepare your D7 and D9 sites, make database backups of both sites so that you can keep snapshots of your progress. Making backups will allow you to roll back either site to an earlier database version if necessary. If you are using Lando, you can export and import using <code>lando db-export &lt;databasepath&gt;</code> and <code>lando db-import &lt;databasepath&gt;</code> while at the root of your site.</p>
  </li>
</ol>

<h3 id="drupal-7-setup">Drupal 7 Setup</h3>

<ol start="6">
  <li>
    <p><strong>Develop a plan for controlling change on your live site.</strong> You typically cannot repeat a second migration once your initial migration has occurred, so to ensure that all the essentials move over in one go, talk with your team about when the best time to migrate the site is — as well as whether configuration, content, users, and other aspects of your D7 site should be frozen at a particular time. If content updates do need to cease, discuss when and for how long. Once migration begins, it is ideal if nothing further is changed on the live Drupal 7 site, but if updates to your live D7 site do have to happen during your migration, discuss how they would be added to the Drupal 9 site.</p>
  </li>
  <li>
    <p><strong>Identify the status of each Drupal 7 module.</strong> Research the modules your D7 site has and categorize them. Some may be compatible with Drupal 9, some may have been moved to Drupal core, and some may not be compatible. Additionally, some modules that are compatible with Drupal 9 may still be in alpha and beta states, in which case they are likely not to have upgrade paths.</p>
  </li>
  <li>
    <p><strong>Create a pre-migration instance of your Drupal 7 site.</strong> While you may have a working local copy of your D7 site, it is best to create a new instance that can be more streamlined with fewer modules turned on. It will likely look different from your fully-functioning local version, and that’s usually fine — as ultimately, it is just a place from which the D9 instance will pull data and files.</p>
  </li>
  <li>
    <p><strong>It is best to turn off Drupal 7 modules that do not have upgrade paths.</strong> Doing so will simplify your upgrade and prevent errors, though it may also mean having to delete the associated fields, configurations, or other site assets in order to prevent migration errors. In these cases, you will need to take additional steps to make sure the Drupal 9 site ends up with these fields and configurations, either by manually re-adding them or by using custom code to support their migration.</p>
  </li>
  <li>
    <p><strong>Clear the Drupal 7 database log before importing it locally.</strong> Before making your migration instance and after backing up your D7 database, I recommend clearing the database log in <code>admin/reports/dblog</code>. For me, it made my database dump smaller and easier to import into my pre-migration site instance, as the watchdog table held far less data that way.</p>
  </li>
</ol>

<h3 id="drupal-9-setup">Drupal 9 Setup</h3>

<ol start="12">
  <li>
    <p><strong>Become familiar with Drupal 9’s environment requirements.</strong> This will help you make sure your local production environment and remote server are set up properly. For instance, you will see from the <a href="https://www.drupal.org/docs/understanding-drupal/how-drupal-9-was-made-and-what-is-included/environment-requirements-of" target="_blank">Environment requirements of Drupal 9</a> that D9 requires PHP 7.3 and Apache 2.4.7. With respect to local setup, Lando should configure the correct PHP version automatically, but other local setup tools may not.</p>
  </li>
  <li>
    <p><strong>Use a fresh Drupal 9 database with no content or configuration.</strong> Refrain from adding any content or content types, and do not configure anything. Only turn on the modules you think you will need. Besides enabling the migration modules, I also turned on the <a href="https://www.drupal.org/project/entity" target="_blank">Entity</a> module.</p>
  </li>
  <li>
    <p><strong>Only enable stable Drupal 9 modules.</strong> Be wary of turning on D9 alpha or beta modules before the migration. You can ensure that you only download stable modules by keeping your <code>composer.json</code> minimum version set to <code>stable</code>. If you choose to download alpha or beta releases, you will want to keep them disabled until after the migration is complete — otherwise, they could adversely affect your site’s database before the migration begins.</p>
  </li>
  <li>
    <p><strong>Enable the Drupal 9 migration modules.</strong> On Drupal 9’s <strong>Extend</strong> panel, turn on all the Migration modules: Migrate, Migrate Drupal, and Migrate UI. 
 Once they are on, go to <code>&lt;sitename&gt;/upgrade</code> to get started.</p>
  </li>
</ol>

<h3 id="troubleshooting-issues">Troubleshooting Issues</h3>

<ol start="16">
  <li>
    <p><strong>Check the list of modules that will not be upgraded.</strong> After you connect to your D7 database, you will likely still see a list of D7 modules that will not be upgraded. Once you see the list, you may want to turn off additional modules and restart the migration.</p>
  </li>
  <li>
    <p><strong>Take notes during and after the migration.</strong> During the migration, you will see messages conveying both progress and any errors. The messages will change quickly, so if you see errors, I recommend copying and pasting representative ones into a text editor. After the migration, check the database logs on your D9 site at <code>/admin/reports/dblog</code> to study errors, warnings, and other messages further.</p>
  </li>
  <li>
    <p><strong>Develop strategies for content that may not automatically move over.</strong> For me, this included content handled by the Field Collection and Video modules, which were not upgraded. This is where you may want to either manuallly re-add the content on your D9 site or try running custom scripts or simply re-adding content to your Drupal 9 site.</p>
  </li>
  <li>
    <p><strong>If necessary, consider more complex approaches.</strong> If you have stubborn upgrade errors produced by parts of your site that you really need, there are more complex migration approaches that offer more options and flexibility while requiring additional coding, additional modules, and a more complex Lando configuration. One such method was presented in this <a href="https://thinktandem.io/blog/2020/04/28/lando-migration-webinar-part-1-followup/" target="_blank">Lando Migration Webinar</a> by <a href="https://thinktandem.io/tag/johno/" target="_blank">John Ouellet</a>, who is well versed in Drupal migrations. I do recommend watching this webinar to get a sense of this type of approach, especially if the process here, which focuses mainly on the essentials, does not move over enough of your content or configuration.</p>
  </li>
</ol>

<h3 id="big-picture">Big Picture</h3>

<ol start="20">
  <li>
    <p><strong>Plan your post-data migration site build.</strong> After migrating the database, the rest of the migration is often a rebuild. Do not expect views or all your layouts to make it over, and anticipate rebuilding your theme using a Drupal 9 starter sub-theme. Plan to re-adding views and other configurations. This part of the process will largely be akin to building a new site.</p>
  </li>
  <li>
    <p><strong>Consider using migration as an opportunity to rethink your site.</strong> Even though  building a D9 site with the same design and site architecture as your D7 version can help to make your upgrade plan straightforward, the fact that you have to rebuild your site pages and theme anyway means that there is an opportunity to rethink design, navigation, and other site aspects — so decide whether you want to use your migration as an opportunity to give your site a new look.</p>
  </li>
</ol>

<p>Thanks for reading, and I hope these tips help you with your Drupal migrations.</p>

  </div><!-- Begin Mailchimp Signup Form -->
<link href="/assets/css/mailchimp.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif; }
	/* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://github.us17.list-manage.com/subscribe/post?u=4bb03207be5c8c1d9ca96decc&amp;id=97065825d9" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<p>Subscribe here to receive developer insights via email.</p>
    <div class="mc-field-group">
    <div id="mc-flex-container">
    	<div id="mc-input-container">
	     <label for="mce-EMAIL">Email Address </label>
         <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
        </div>
	  <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
    </div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>  
	 <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true">
    	<input type="text" name="b_4bb03207be5c8c1d9ca96decc_97065825d9" tabindex="-1" value=""></div>
   
      
  
</form>
</div>
<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';fnames[3]='ADDRESS';ftypes[3]='address';fnames[4]='PHONE';ftypes[4]='phone';fnames[5]='BIRTHDAY';ftypes[5]='birthday';}(jQuery));var $mcj = jQuery.noConflict(true);</script>


<script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/4bb03207be5c8c1d9ca96decc/57a839b09029954a911770f68.js");</script>


<!--End mc_embed_signup--><a class="u-url" href="/2021/03/13/drupal-migration-takeaways.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  
  <data class="u-url" href="/"></data>

  <div class="wrapper">

 

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <h2 id="footer-heading">Nevin Katz</h2>
        <h2 id="footer-subheading">Web &amp; App Developer</h2>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/nevkatz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">nevkatz</span></a></li><li><a href="https://www.linkedin.com/in/nevin-katz-7744244"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">nevin-katz-7744244</span></a></li><li><a href="https://www.twitter.com/nevkatz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">nevkatz</span></a></li></ul>
<a class="u-email" href="mailto:nevkatz@gmail.com">nevkatz@gmail.com
            </a>
  
      </div>  
    </div>
   

  </div>
   <div id="copyright">
    <p>Copyright &copy; 2021 Nevin Katz. All Rights Reserved.</p>
   </div>

</footer>
<script src="/assets/js/simple-jekyll-search.min.js"></script>
<script src="/assets/js/prism.js"></script>
<script src="/assets/js/script.js"></script>



</body>

</html>
