<!DOCTYPE html>
<html lang="en"><!-- http://jovandeginste.github.io/2016/05/18/add-metadata-tags-to-jekyll-blog-posts.html   -->
<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-146443473-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-146443473-1');
</script>
<script data-ad-client="ca-pub-9580495616409314" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:url" content="/2020/01/04/powershell-intro.html" />
  
  <meta itemprop="keywords" content="powershell,drupal">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>My Powershell Journey Begins | nevkatz media</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="My Powershell Journey Begins" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I did not know Powershell existed" />
<meta property="og:description" content="I did not know Powershell existed" />
<link rel="canonical" href="/2020/01/04/powershell-intro.html" />
<meta property="og:url" content="/2020/01/04/powershell-intro.html" />
<meta property="og:site_name" content="nevkatz media" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-01-04T00:00:00-05:00" />
<script type="application/ld+json">
{"headline":"My Powershell Journey Begins","dateModified":"2020-01-04T00:00:00-05:00","datePublished":"2020-01-04T00:00:00-05:00","url":"/2020/01/04/powershell-intro.html","mainEntityOfPage":{"@type":"WebPage","@id":"/2020/01/04/powershell-intro.html"},"description":"I did not know Powershell existed","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/prism.css">
  <link rel="stylesheet" href="/assets/css/styles.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="nevkatz media" /></head>
<body ><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">nevkatz media</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <!--<a class="page-link" href="/about/">About</a><a class="page-link" href="/index.html">nevkatz media</a>-->
           <a class="page-link" href="/about">About</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">My Powershell Journey Begins</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-01-04T00:00:00-05:00" itemprop="datePublished">Jan 4, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h3 id="i-did-not-know-powershell-existed">I did not know Powershell existed</h3>

<p>…until a couple months ago. It fell under my radar for the first time during a meeting. I had been pondering how to write a small desktop application that allowed Drupal website content creators to pull down the lessons they had created on an authoring website and package them into a nice, neat folder that could be loaded onto Android tablets for use by our app.</p>

<h4 id="the-goal">The Goal</h4>

<p>I told my colleagues that my application would live on a local machine and should work like this:</p>
<ul>
  <li>pull down files from the Drupal site</li>
  <li>create new files when needed</li>
  <li>build out its directory structure as it hummed along</li>
  <li>gave the content person reasonable indications of download progress</li>
</ul>

<p>While I had been thinking about building it in C#, which would have been quite a learning curve for me, a colleague of mine suggested that I try building it in a language called Powershell. While it is a tool typically used by web admins, and while the final product would have to be a text-based interface, it is fast, can work on both Macs and PCs, and has the functionality necessary to get the job done efficiently.</p>

<h4 id="some-background">Some Background</h4>

<p>For those of you who are new to this stuff, a <em>shell</em> is a textual user interface that allows you to use different services of your computer’s operating system (OS) and run specific programs.</p>

<p><em>Windows Powershell</em> is a shell environment built on the .NET framework that was originally developed by Microsoft for administrative and other “under-the-hood” tasks. It has its own scripting language — the commands you can use are called <em>cmdlets</em> - and has been an integral part of the Windows OS for some time now. A new version of it, called <em>Powershell Core</em>, is cross-platform and will run on Macs with an OS of 10.12 and above. <em>Powershell Core</em> is the version I use, as I currently work mainly in a Mac environment.</p>

<p>There are quite a few differences between Windows Powershell and Powershell Core, and to me the most notable difference is that Windows Powershell has quite a few more cmdlets (aka commands.) The differences between the two are discussed in detail on this <a href="http://techgenix.com/powershell-core/" target="_blank">techgenix.com</a> post.</p>

<h4 id="the-interface">The Interface</h4>

<p>Because Powershell is a shell application, it will run within a Mac’s terminal app, and for Windows, it runs with its own interpreter that can read and execute its code line-by-line. The interface is all textual and a powershell script you write will not have a graphic user interface (GUI) out-of the-box (or at all, if you are on a Mac). So to some users, the interface of a powershell application will be reminiscent of the old-school computers from the pre-GUI days.</p>

<p>If you are building for Windows, you can build a GUI for a Powershell application but you don’t have to if your users are fine using the textual UI. That said, the GUI packages are not yet available for Powershell Core - so a cross-platform application or non-Windows application should not have a GUI. You can learn more about when a GUI may be appropriate via this <a href="https://poshland.pro/3-scenarios-gui-powershell-script/">poshland.pro</a> article.</p>

<h4 id="what-i-have-learned-thus-far">What I have learned thus far</h4>

<p>With some guidance from colleagues, I downloaded PowerShell Core and started exploring. The very first thing I tried to do was a simple GET request to a JSON file living on my Drupal site. I was thrilled at how fast I was able to get it to work!</p>

<p>As I evolved my script, I primarily added the following logic:</p>

<ul>
  <li>making an asynchronous GET request to a JSON file</li>
  <li>saving the file to my desktop</li>
  <li>using a <code>while</code> loop checking on file size to check download completion</li>
  <li>converting between JSON text and a JSON object</li>
  <li>iterating through a JSON object using a <code>for</code> loop</li>
  <li>creating a directory</li>
  <li>listing the files in the directory</li>
  <li>converting a string to an array with a delimiter (ex. ‘/’)</li>
  <li>creating and modifying an array and a JSON object</li>
</ul>

<h4 id="takeaways">Takeaways</h4>

<p>Below are some of my takeaways thus far.</p>

<ul>
  <li>
    <p><strong>You can run powershell cmdlets and define variables directly in the interface.</strong> You can type them in one-by-one and see how they work.</p>
  </li>
  <li>
    <p><strong>Familiar programming conventions.</strong> All the typical programming conventions I have needed, including all the standard loops I use (while, for, foreach, etc.), as well as array logic, server requests, File I/O, and JSON logic, are there.</p>
  </li>
  <li>
    <p><strong>Powershell is dynamically typed.</strong> You can also cast variables as particular types, which is handy.</p>
  </li>
  <li>
    <p><strong>Pipeline syntax is available</strong> and can make code shorter (but sometimes less clear.) I have not used these much in my script, but it is a strong point of Powershell. You can find a super quick example here at <a href="https://ss64.com/ps/syntax-pipeline.html">ss64.com</a>.</p>
  </li>
  <li>
    <p><strong>Powershell is very JSON-friendly.</strong> If you ask it to print a JSON object, it will actually print some or all of its properties. Switching between JSON Objects and the equivalent strings is easy. Because my script is pulling info from the Drupal site and interpreting it, this particular script is heavy on JSON, so having this functionality is terrific.</p>
  </li>
  <li>
    <p><strong>There is tons of documentation out there!</strong> The is tons of great documentation and from what I can tell, the language has stabilized. Just be vigilant about ditinguishing code that uses Windows-specific commands.</p>
  </li>
  <li>
    <p><strong>The language has been easy to pick up.</strong> While I have coded in C, Objective-C, OCaml, and PHP, my primary day-to-day programming language is Javascript. That said, learning powershell syntax has been straightforward. Like all languages, it has its own syntax.</p>
  </li>
  <li>
    <p><strong> Testing is quick.</strong> There is no compilation step, no browser to refresh, and no device to send the code to - so you can do a lot of rapid testing.</p>
  </li>
  <li>
    <p><strong>Asynchronous requests are supported.</strong> As with Javascript, you have to be careful about distinguishing between synchronous and asynchronous commands. Unlike JS, which uses callbacks and promises, it can be tricky to tell whether an async process has completed, so you may need to write some code to check for completion.</p>
  </li>
  <li>
    <p><strong>You can run a script that uses multiple files.</strong> As my codebase gets larger, I am finding it helpful to have files containing helper functions. You can include this with a dot and the relative filepath: <code>. ./myfile.ps1</code></p>
  </li>
</ul>

<h4 id="closing">Closing</h4>

<p>So my journey with PowerShell has begun, and over the course of the past month, I have created an Powershell script that does its job fast. My goal over the next month will be to start testing in a Windows 10 environment (using Mac Parallels) and make it as easy as possible to use by content creators, who will have to transition from point-and-click GUIs to text-based interfaces. I am also working on adding functionality for swapping in large video files during and after the download process.</p>


  </div><div id="disqus_thread"></div>
    <script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
  var d = document, s = d.createElement('script');
  s.src = 'https://nevkatz.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a class="u-url" href="/2020/01/04/powershell-intro.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">nevkatz media</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name"><!-- nevkatz media --></li><li><a class="u-email" href="mailto:nevkatz@gmail.com">nevkatz@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/nevkatz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">nevkatz</span></a></li><li><a href="https://www.twitter.com/nevkatz"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">nevkatz</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Art and coding are two sides of the same coin.</p>
      </div>

      
    </div>
   

  </div>
   <div id="copyright">
    <p>Copyright &copy; 2019 Nevin Katz. All Rights Reserved.</p>
   </div>

</footer>
<script src="/assets/js/prism.js"></script>
<script src="/assets/js/script.js"></script>

</body>

</html>
